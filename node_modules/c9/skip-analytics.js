if (define === undefined) {
    var define = function(fn) {
        fn(require, exports, module);
    };
}

define(function(require, exports, module) {
    "use strict";

    var hasInternalDomain = require("c9/has-internal-domain");
    var hasInternalTestName = require("c9/has-internal-test-name");

    function skipAnalytics(user, allowUnauthorized) {
        if (!user) return true;

        if (!allowUnauthorized && hasUnauthorizedId(user)) return true;

        if (hasInternalTestName(user)) return true;
        if (hasInternalDomain(user.email)) return true;
        return false;
    }

    function hasUnauthorizedId(user) {
        if (user.id === -1) return true;

        if (!user.id && user.uid === -1) return true;
    }

    module.exports = skipAnalytics;
});